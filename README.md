# HAProxy and CNS a story of automation

This repository is an example of using HAProxy together with Triton CNS to add backend servers to the pool using SRV records generated by Triton CNS, the `server-template` directive and a simple Node.js Express application as the backend. This example can be used with or without the Ansible playbook included.

Included in this repository are commands to provision three instances, one for the HAproxy frontend, and two for the Node.js Express backend.  The commands included the syntax for tagging the frontend instance with a tag of `frontend` and the backend Node.js instances have the service tags of `_backend._tcp:3000` to generate an SRV record that will advertise the DNS name and resulting IP address of the backend instances as well as the port (3000) that the express app will serve.

The HAproxy configuration example includes a template for 3 backend servers so that after building the initial two, you can provision a third with the same tags and it will automatically be added to the available backend servers.
